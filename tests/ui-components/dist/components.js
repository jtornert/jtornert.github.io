import{signal as l,effect as u}from"datastar";function o(n){return n.id?n.id:"i"+Math.random().toString(36).slice(2)}window.customElements.define("ui-accordion",class extends HTMLElement{static{this.observedAttributes=["persistent"]}constructor(){super(),this.current=l(null);let n=this.querySelectorAll(":scope > :is(h2,h3,h4,h5,h6) > button"),s=this.querySelectorAll(":scope > div");for(let t=0;t<n.length;++t){let e=n[t],r=s[t];e.id=o(e),r.setAttribute("aria-labelledby",e.id)}this.persistent=l(this.getAttribute("persistent")===""),this.cleanup=u(()=>{let t=this.current(),e=this.persistent(),r=this.querySelectorAll(":scope > :is(h2,h3,h4,h5,h6) > button[aria-expanded=true]");if(r.length>1)throw new Error("cannot have several panels open at once");if(r[0]?.removeAttribute("aria-expanded"),t===null){e&&this.querySelector(":scope > :is(h2,h3,h4,h5,h6) > button")?.setAttribute("aria-expanded","true");return}this.querySelector(`:scope > :nth-child(${t+1}) > button`)?.setAttribute("aria-expanded","true")}),this.addEventListener("click",t=>{let e=t.target;if(e.tagName!=="BUTTON")return;let r=e.parentElement,i=Array.prototype.findIndex.call(this.children,c=>c===r),a=this.current();!this.persistent()&&(i===a||i===-1)?this.current(null):this.current(i)})}disconnectedCallback(){this.cleanup()}attributeChangedCallback(n,s,t){n==="persistent"&&this.persistent(t==="")}});
